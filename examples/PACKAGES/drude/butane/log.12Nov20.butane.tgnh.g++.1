LAMMPS (29 Oct 2020)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:94)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0.0      0.0      0.5     
  special bond factors coul:  0.0      0.0      0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.005 seconds
  read_data CPU = 0.107 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.002 seconds

fix fNVT all tgnvt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 1 20.0

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:328)
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 79507 46656
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
TGNHC thermostat for Drude model
  DOFs of molecules, atoms and dipoles: 747.0 7250.0 3000.0
Per MPI rank memory allocation (min/avg/max) = 26.74 | 26.74 | 26.74 Mbytes
Step CPU TotEng KinEng Temp PotEng E_bond E_angle E_dihed E_impro E_vdwl E_coul E_long Press Volume c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3] 
       0            0    6535.5187      2714.74    248.45112    3820.7787    3724.3278    140.75328    1.4735401            0   -518.77975    595169.42   -594696.41    4439.7916    55742.797    334.61375    18.435655    235.53872    344.96036    18.435655 
      50    3.1687763    2088.2827    1463.7181    133.95847    624.56452    190.24602    660.52157    113.41252            0   -767.94561    595300.94   -594872.61    2824.2625    55742.797    183.94884    0.5168738    309.18564    171.12124    0.5168738 
     100     6.392197     2119.741     1619.097    148.17863    500.64399    180.00042    696.41212    164.28885            0   -972.75524    595305.17   -594872.47    1212.6136    55742.797    203.63725   0.14080733    399.49069    183.54186   0.14080733 
     150    9.5800587    2141.3837    1671.6283    152.98627    469.75531     135.1638     703.8743     168.6738            0   -966.11416    595300.45   -594872.29    4391.1694    55742.797    210.25781   0.10918071    418.15558    188.92417   0.10918071 
     200    12.853705    2171.9506    1663.8326    152.27281    508.11794    189.68939    718.42616     166.2915            0   -990.53041    595295.36   -594871.12    2071.4055    55742.797    209.24314   0.19965091    435.49843    186.01763   0.19965091 
     250    16.067977    2208.7064    1678.7069     153.6341    529.99951    152.56393    831.36872    167.05009            0   -1047.6813    595297.24   -594870.54    1092.2375    55742.797    210.84693   0.91289443    438.53468    187.47449   0.91289443 
     300    19.290601    2251.9246    1764.9742    161.52921    486.95043    145.17235    805.81497    155.39025            0   -1045.9572    595297.21   -594870.68    2438.7801    55742.797    220.85043     3.177778    427.70756     199.6284     3.177778 
     350    22.523101    2270.9632    1684.9306    154.20368    586.03264    186.29543    828.98436    164.45539            0   -1016.9035    595293.56   -594870.36    2804.0926    55742.797    211.53678    1.1611927    408.91355     191.2877    1.1611927 
     400    25.747934     2299.236    1742.1505    159.44041     557.0855    171.75438    844.97783    181.89643            0   -1068.3059    595296.85   -594870.09    346.86959    55742.797    219.02792   0.38093991    392.66374    201.22808   0.38093991 
     450    28.921993    2335.9622    1666.2461    152.49369    669.71602     137.8956    986.46039    179.59582            0    -1060.189    595295.82   -594869.86   -125.83593    55742.797    209.50259   0.31748182    376.15783    192.41804   0.31748182 
     500    32.312988     2377.923    1744.8977    159.69183    633.02533    192.86619    865.11335    173.23166            0   -1020.1061    595291.45   -594869.53    3306.7537    55742.797    219.29509   0.59010722    361.05703    204.77946   0.59010722 
     550    36.691992    2428.1816     1631.766    149.33809    796.41562    183.75276    1043.9175    175.64604            0   -1030.3844    595293.08    -594869.6    1566.0362    55742.797    204.67411    1.6260367    344.40559    190.36165    1.6260367 
     600    41.042781    2475.0304     1615.769    147.87406    859.26146    195.35951    1102.8743    185.82441            0   -1049.7179    595293.93      -594869    751.07631    55742.797     202.5711    1.8674049     324.5681    190.08503    1.8674049 
     650    45.328915    2516.5445    1706.6033    156.18716    809.94113    177.34479    1029.3219    186.91492            0   -1005.4619     595290.9   -594869.08    2456.1336    55742.797    214.42466   0.73094758    306.66872    205.00907   0.73094758 
     700    49.764606    2566.0671    1658.8261    151.81461    907.24102    186.97528    1088.6916    184.51371            0   -976.01174    595292.41   -594869.33    403.91053    55742.797    208.52534   0.43420426    292.04619     200.0061   0.43420426 
     750    54.232008    2621.7889    1798.1047     164.5613    823.68424    181.39689    1029.9425    187.40871            0   -1005.4402    595300.06   -594869.68    93.345406    55742.797    226.01979   0.50741755    278.62961    220.69269   0.50741755 
     800    58.691111    2682.2116    1697.0698    155.31465    985.14182    215.09199    1113.1134      201.785            0   -975.13212    595300.04   -594869.76   -978.97822    55742.797    213.08116     1.115316    269.45572    207.36081     1.115316 
     850    63.191067    2745.8302    1887.0667    172.70304    858.76349    213.25376    980.55106    184.54859            0   -948.21117    595298.22    -594869.6   -1842.9661    55742.797    236.69142    1.8946563    265.28903    233.84282    1.8946563 
     900    68.297608    2799.3194    1855.1338    169.78056     944.1856    201.04167    1103.4608     183.6645            0   -978.27382    595303.89   -594869.59   -1771.6573    55742.797    232.95614    1.1425454    262.10904    230.04879    1.1425454 
     950    72.791466    2852.8885    1809.5899    165.61241    1043.2986     249.1926    1129.6516     191.5705            0   -961.04118     595303.8   -594869.88   -2342.8998    55742.797    227.44427   0.56184866    253.71617    224.83147   0.56184866 
    1000    77.035667    2910.6565    1900.2429    173.90892    1010.4136    196.79043     1117.444    178.94619            0   -911.75161    595298.72   -594869.74   -30.451099    55742.797    238.87602   0.48940683    245.53211    238.28906   0.48940683 
    1050    81.411119     2970.473    1950.8452       178.54    1019.6278    226.17987    1113.3407    186.50456            0   -935.79287    595298.24   -594868.85   -835.03656    55742.797    245.11923   0.81684119    243.27893    245.41028   0.81684119 
    1100    85.352255    3032.1777    1913.2921    175.10317    1118.8856    252.39337    1183.7624    209.49478            0   -958.58165    595300.89   -594869.07   -2339.7573    55742.797    240.10633    1.5863163    244.29251    239.77436    1.5863163 
    1150    88.542324    3088.7233    2015.1572     184.4258    1073.5661    215.84757    1132.2268    209.14846            0   -912.58909    595297.76   -594868.83    53.404069    55742.797    252.92982    1.5639609     247.6541    253.57807    1.5639609 
    1200    92.122601    3137.9447    1895.1546    173.44324    1242.7901    238.97673     1266.308    207.46165            0   -898.18367    595297.09   -594868.86   -940.55827    55742.797    238.13441   0.75999751    245.44164    237.48006   0.75999751 
    1250    95.311451    3187.5696    2117.7204    193.81231    1069.8492    181.35781    1173.5116    216.10446            0   -933.15422    595300.81   -594868.78     -1638.23    55742.797    266.21428   0.54658889    243.60628    268.65384   0.54658889 
    1300    98.511654    3238.1405    2050.9414    187.70074    1187.1991    249.20898    1196.3016    223.50078            0    -909.6591     595296.3   -594868.46   -1547.4617    55742.797    257.76705    0.6695258    252.14097     258.4534    0.6695258 
    1350    101.52721    3288.0387    2035.6917     186.3051     1252.347    218.31874     1254.421    222.85512            0   -868.43705    595293.49    -594868.3    390.90212    55742.797    255.64252    1.2189872    257.21253    255.58654    1.2189872 
    1400    104.52829    3334.0324    2200.7086    201.40733    1133.3238      203.591    1213.1272    225.86605            0   -936.79465    595295.53      -594868    1372.2474    55742.797    276.25415    1.6144005    265.70225    277.45567    1.6144005 
    1450    107.57536    3365.7397     2053.535     187.9381    1312.2047    229.27407    1349.3993    233.25524            0   -924.22271    595292.17   -594867.67   -836.52213    55742.797    257.94919     1.053914     270.4816    256.76466     1.053914 
    1500    110.67807    3391.6801    2142.1349    196.04671    1249.5452    216.36803     1271.289    236.65847            0     -894.899    595287.51   -594867.38    1789.6923    55742.797    269.25236   0.63559736    274.68538    268.80398   0.63559736 
    1550    113.65872    3411.9839    2115.0942    193.57196    1296.8897    192.92659    1363.4027    230.98652            0   -914.70137    595291.47   -594867.19    2191.6084    55742.797    265.85125   0.63359087    272.59399    265.26653   0.63359087 
    1600    116.66477    3424.9783    2002.6546    183.28156    1422.3237    261.62038    1419.7862    242.17905            0   -928.05995    595294.38   -594867.58   -1278.1217    55742.797    251.58666   0.95135757    265.94171     250.2117   0.95135757 
    1650    119.69122    3429.9661    2102.8573    192.45205    1327.1088    253.88883    1296.8164    239.01537            0   -888.25345    595293.11   -594867.47    948.16575    55742.797    263.99864    1.4686915    261.93718    264.32028    1.4686915 
    1700    122.69838     3421.465    2141.4791    195.98669    1279.9859    181.31236     1326.081    226.54243            0   -878.86521    595292.19   -594867.28    241.93125    55742.797     268.9293    1.2770595    262.79349    269.67278    1.2770595 
    1750    125.70436    3402.5396    2090.1999    191.29365    1312.3397    263.74025    1296.4274    228.60032            0   -905.54661    595296.37   -594867.25   -1707.3557    55742.797    262.65583   0.80319616    257.84463    263.26023   0.80319616 
    1800    128.64288    3381.1607    2133.1735    195.22657    1247.9872    234.93738     1242.035    231.34689            0   -887.78079    595295.05    -594867.6   -6.7713651    55742.797    268.11425   0.66416955    258.06107    269.26102   0.66416955 
    1850    131.64553    3358.3375    2097.2908     191.9426    1261.0467    207.32514    1269.9582    225.83462            0   -867.84477    595293.05   -594867.28    1032.3077    55742.797    263.55741   0.77783532    261.21918    263.90739   0.77783532 
    1900    134.66459    3335.0634    2130.3209    194.96549    1204.7425    244.28549    1208.9691    209.87044            0   -885.54671     595293.8   -594866.63   -302.54262    55742.797    267.53309    1.2569444    256.95232    268.73397    1.2569444 
    1950    137.77487    3309.5009     2065.148    189.00092    1244.3529    244.25407    1240.7976    222.92873            0   -891.58467    595294.86    -594866.9   -2000.0789    55742.797    259.29344    1.3652015    254.19331    259.92622    1.3652015 
    2000    140.88126    3284.0767    2005.7474    183.56462    1278.3292    226.17277    1236.5565    225.16671            0   -837.57878    595295.52   -594867.51    942.09961    55742.797    251.97128   0.96329477     250.4516    252.23212   0.96329477 
Loop time of 140.882 on 1 procs for 2000 steps with 4500 atoms

Performance: 0.613 ns/day, 39.134 hours/ns, 14.196 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.189     | 90.189     | 90.189     |   0.0 | 64.02
Bond    | 5.0432     | 5.0432     | 5.0432     |   0.0 |  3.58
Kspace  | 39.478     | 39.478     | 39.478     |   0.0 | 28.02
Neigh   | 2.4322     | 2.4322     | 2.4322     |   0.0 |  1.73
Comm    | 0.62876    | 0.62876    | 0.62876    |   0.0 |  0.45
Output  | 0.021652   | 0.021652   | 0.021652   |   0.0 |  0.02
Modify  | 2.9918     | 2.9918     | 2.9918     |   0.0 |  2.12
Other   |            | 0.09631    |            |       |  0.07

Nlocal:        4500.00 ave        4500 max        4500 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:        9440.00 ave        9440 max        9440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:       811251.0 ave      811251 max      811251 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 811251
Ave neighs/atom = 180.27800
Ave special neighs/atom = 13.333333
Neighbor list builds = 31
Dangerous builds = 0
Total wall time: 0:02:21
