LAMMPS (29 Oct 2020)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:94)
  using 1 OpenMP thread(s) per MPI task
# 250 butane system for drude polarizability example (Langevin)

units real
boundary p p p

atom_style full
bond_style harmonic
angle_style harmonic
dihedral_style opls
special_bonds lj/coul 0.0 0.0 0.5

pair_style hybrid/overlay lj/cut/coul/long 8.0 8.0 thole 2.089 8.0
pair_modify mix geometric tail yes
kspace_style pppm 1.0e-4

read_data data.butane
Reading data file ...
  orthogonal box = (-19.099988 -19.099913 -19.099998) to (19.099998 19.099999 19.099987)
  2 by 1 by 2 MPI processor grid
  reading atoms ...
  4500 atoms
  scanning bonds ...
  5 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  9 = max dihedrals/atom
  reading bonds ...
  4250 bonds
  reading angles ...
  6000 angles
  reading dihedrals ...
  6750 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0.0      0.0      0.5     
  special bond factors coul:  0.0      0.0      0.5     
     5 = max # of 1-2 neighbors
     8 = max # of 1-3 neighbors
    12 = max # of 1-4 neighbors
    17 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_data CPU = 0.135 seconds

comm_modify vel yes

group gBUTANE molecule 1:250
4500 atoms in group gBUTANE
group gCORES type 1 2 3
3500 atoms in group gCORES
group gDRUDES type 4 5
1000 atoms in group gDRUDES

pair_coeff    1    1 lj/cut/coul/long 0.065997 3.500000 # C3H C3H
pair_coeff    1    2 lj/cut/coul/long 0.065997 3.500000 # C3H C2H
pair_coeff    1    3 lj/cut/coul/long 0.044496 2.958040 # C3H H
pair_coeff    2    2 lj/cut/coul/long 0.065997 3.500000 # C2H C2H
pair_coeff    2    3 lj/cut/coul/long 0.044496 2.958040 # C2H H
pair_coeff    3    3 lj/cut/coul/long 0.029999 2.500000 # H H
pair_coeff    *  4*5 lj/cut/coul/long 0.000000 0.000000 # No lj for drudes
pair_coeff    1    * thole 1.368000
pair_coeff    2    * thole 1.368000
pair_coeff    4    * thole 1.368000
pair_coeff    5    * thole 1.368000

neighbor 2.0 bin

variable vTEMP   equal 260.0
variable vTEMP_D equal 1.0
variable vPRESS  equal 1.0

velocity gCORES  create ${vTEMP} 12345
velocity gCORES  create 260 12345
velocity gDRUDES create ${vTEMP_D} 12345
velocity gDRUDES create 1 12345

fix fDRUDE all drude C C N D D

fix fSHAKE gCORES shake 0.0001 20 0 b 2 4
       0 = # of size 2 clusters
     500 = # of size 3 clusters
     500 = # of size 4 clusters
       0 = # of frozen angles
  find clusters CPU = 0.003 seconds

fix fNVT all tgnvt/drude temp ${vTEMP} ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 ${vTEMP} 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 ${vTEMP_D} 20.0
fix fNVT all tgnvt/drude temp 260 260 100.0 1 20.0

compute cTEMP all temp/drude

thermo_style custom step cpu etotal ke temp pe ebond eangle edihed eimp evdwl ecoul elong press vol c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3]
thermo 50

timestep 0.5
run 2000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:328)
  G vector (1/distance) = 0.36786669
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.031353958
  estimated relative force accuracy = 9.4421513e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 26875 11664
Rebuild special list taking Drude particles into account
Old max number of 1-2 to 1-4 neighbors: 17
New max number of 1-2 to 1-4 neighbors: 17 (+0)
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 8 8 8
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair lj/cut/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
  (2) pair thole, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
TGNHC thermostat for Drude model
  DOFs of molecules, atoms and dipoles: 747.0 7250.0 3000.0
Per MPI rank memory allocation (min/avg/max) = 17.33 | 17.61 | 17.71 Mbytes
Step CPU TotEng KinEng Temp PotEng E_bond E_angle E_dihed E_impro E_vdwl E_coul E_long Press Volume c_cTEMP[1] c_cTEMP[2] f_fNVT[1] f_fNVT[2] f_fNVT[3] 
       0            0    6535.5187      2714.74    248.45112    3820.7787    3724.3278    140.75328    1.4735401            0   -518.77975    595169.42   -594696.41    4439.7916    55742.797    334.61375    18.435655    235.53872    344.96036    18.435655 
      50    1.2808116    2088.3442    1463.7416    133.96062    624.60259    190.28732    660.54143    113.40785            0   -767.95454    595300.93   -594872.61    2824.0523    55742.797     183.9497   0.52468068    309.23594    171.11764   0.52468068 
     100    2.5584104    2119.7471    1619.1466    148.18318    500.60051     180.0129    696.37693    164.27736            0   -972.76956    595305.17   -594872.47    1212.1148    55742.797    203.64285   0.14251823    399.52878    183.54411   0.14251823 
     150    3.8010236    2141.3696    1671.6877    152.99171    469.68182     135.1764    703.84494     168.6598            0   -966.14516    595300.44   -594872.29     4390.752    55742.797    210.26485   0.11034179    418.18146    188.92927   0.11034179 
     200    5.1283429    2171.9547    1663.9057     152.2795    508.04901    189.69207    718.41361    166.26728            0   -990.56316    595295.36   -594871.12    2071.2788    55742.797    209.25133   0.20233224    435.53114     186.0233   0.20233224 
     250    6.4042978    2208.7763    1678.8339    153.64571    529.94239    152.60724    831.35366    166.99449            0   -1047.7147    595297.24   -594870.54      1092.02    55742.797    210.85827    0.9252592    438.54342     187.4861    0.9252592 
     300    7.6759895    2251.8197     1764.844     161.5173    486.97577    145.12518    805.82891    155.36767            0   -1045.8941    595297.22   -594870.68    2440.3181    55742.797    220.83898    3.1684561    427.70245    199.61611    3.1684561 
     350    8.9352416    2270.8953    1684.8322    154.19468    586.06305    186.26267     828.9806    164.47014            0   -1016.8664    595293.58   -594870.36    2805.0915    55742.797    211.52748     1.151954    408.90784    191.27829     1.151954 
     400    10.226474    2299.1993    1742.2608     159.4505    556.93851    171.73982    844.94626    181.87018            0   -1068.3641    595296.84   -594870.09    346.42411    55742.797    219.04152   0.38166821    392.61871    201.24772   0.38166821 
     450    11.460384     2335.947    1666.1971     152.4892    669.74994    137.90858    986.43107    179.60302            0   -1060.1348    595295.81   -594869.87   -124.88535    55742.797    209.49545   0.32005879    376.11474    192.41461   0.32005879 
     500    12.727526    2377.9345    1744.9374    159.69546    632.99715     192.8966    865.02273    173.24203            0   -1020.0569    595291.42   -594869.52    3307.6909    55742.797    219.29743   0.59718599    361.06132    204.78161   0.59718599 
     550    14.002285    2428.2193    1631.8271    149.34369     796.3922    183.78402    1043.8511    175.66575            0   -1030.3885    595293.08    -594869.6    1565.6449    55742.797     204.6776    1.6372397    344.46071    190.35982    1.6372397 
     600    15.309195    2474.8599    1615.6237    147.86076    859.23616    195.26628    1102.8384    185.89393            0   -1049.6659    595293.91   -594869.01    751.15809    55742.797    202.55856    1.8521167    324.58977    190.06895    1.8521167 
     650    16.528946    2516.5107    1706.7483    156.20043    809.76241    177.33665    1029.1545     186.8922            0   -1005.4741    595290.93   -594869.08    2457.4736    55742.797    214.44458   0.72647262    306.69821    205.02801   0.72647262 
     700    17.788857    2566.0306    1658.7538      151.808    907.27687     187.0133    1088.6084    184.61388            0   -976.00491    595292.38   -594869.33    403.14977    55742.797    208.51586   0.43547213    292.00328    200.00013   0.43547213 
     750    19.056136    2621.8108    1798.0665     164.5578    823.74429    181.38067    1030.1211    187.24746            0   -1005.3911    595300.06   -594869.68    92.552993    55742.797    226.01327   0.51200863    278.52415    220.69636   0.51200863 
     800    20.328816    2682.2638    1697.1503    155.32202    985.11349    215.11037    1113.1057    201.61206            0   -974.97574    595300.02   -594869.76   -976.02218    55742.797    213.08709    1.1265124    269.37146    207.37604    1.1265124 
     850    21.675028    2745.7956    1887.1133    172.70731    858.68222    213.20281    980.38605    184.58101            0   -948.10772    595298.22    -594869.6    -1838.829    55742.797    236.69968    1.8882632    265.22854    233.85817    1.8882632 
     900    22.973234    2799.2121    1855.3963    169.80459    943.81573    200.99559    1103.2167    183.64073            0   -978.26954    595303.83   -594869.59   -1773.6417    55742.797    232.99302    1.1323134    262.06588    230.09392    1.1323134 
     950    24.248459    2852.9103    1809.6345     165.6165    1043.2758    249.23659    1129.5155    191.54177            0   -960.95833    595303.82   -594869.88   -2343.6579    55742.797    227.45041   0.56047502    253.63589    224.84652   0.56047502 
    1000    25.536354    2910.7011    1900.5669    173.93856    1010.1343    196.76213    1117.2835    179.06956            0    -911.9529    595298.71   -594869.74   -33.375682    55742.797    238.91568   0.49230975    245.54917    238.33106   0.49230975 
    1050    27.032801     2970.593    1950.7545    178.53171    1019.8385    226.09391    1113.2803    186.61907            0   -935.59614    595298.29   -594868.85   -832.86686    55742.797    245.10467   0.82528071    243.25364    245.39681   0.82528071 
    1100    28.276849     3032.248    1914.0097    175.16884    1118.2383     252.4222    1183.4081    209.13741            0   -958.53105    595300.88   -594869.07   -2341.1239    55742.797    240.19374    1.5939531     244.2841    239.87168    1.5939531 
    1150    29.492505    3088.6987    2014.6006    184.37485    1074.0982    215.76487    1132.4575    209.01044            0   -912.08646    595297.78   -594868.83    59.335425    55742.797    252.86479    1.5506297    247.67435    253.50422    1.5506297 
    1200    30.792128     3137.976    1895.5574     173.4801    1242.4187    239.01663    1266.2435    206.94828            0   -898.01399    595297.09   -594868.87   -935.85119    55742.797    238.18675   0.75585601    245.80184    237.50082   0.75585601 
    1250    32.351654    3187.6007    2118.7576    193.90723    1068.8431    181.27841    1173.4284    215.72666            0   -933.61935    595300.82   -594868.79   -1641.4966    55742.797    266.34429   0.54783845    244.09536    268.74691   0.54783845 
    1300    34.279555    3238.1339    2050.9128    187.69812    1187.2212    249.09831    1195.8579    223.95802            0   -909.52255    595296.29   -594868.46   -1548.7665    55742.797    257.76137   0.67507496    252.48992    258.41118   0.67507496 
    1350    36.142639    3287.8996    2035.6486    186.30115     1252.251    218.35091    1254.3488    223.36318            0   -868.93347    595293.43   -594868.31    385.64561    55742.797    255.63367    1.2281317    257.51447    255.54567    1.2281317 
    1400    37.680265    3333.7702    2200.7264    201.40895    1133.0439    203.40304     1213.391    225.99045            0   -937.20521    595295.47   -594868.01    1368.2351    55742.797    276.25818    1.6096154    265.82263    277.44771    1.6096154 
    1450    38.930719    3365.4323     2053.468    187.93197    1311.9643    229.10608    1350.1009    232.99574            0   -924.67313    595292.11   -594867.67   -844.05749    55742.797    257.94445    1.0440927    270.14303    256.79431    1.0440927 
    1500    40.161434    3391.3707    2141.7727    196.01356     1249.598     216.2106    1271.1542    236.52415            0   -894.39832    595287.52   -594867.41    1800.4964    55742.797    269.20769   0.63415006    273.93125    268.83182   0.63415006 
    1550    41.331434    3411.6894    2114.0335    193.47488    1297.6559     192.9656     1363.167    231.27359            0   -913.98645    595291.45   -594867.21    2209.1641    55742.797    265.71649   0.63741948    271.92193    265.18682   0.63741948 
    1600    42.514856    3424.7938    2003.2634    183.33728    1421.5305    261.67378     1419.189    241.66354            0   -927.77417    595294.37    -594867.6   -1282.8296    55742.797     251.6594   0.96160577    265.79668    250.30691   0.96160577 
    1650    43.712954    3429.9764    2104.4785    192.60041    1325.4979    253.75783    1296.7732    237.25083            0   -887.95744    595293.15   -594867.48    966.66903    55742.797    264.20211    1.4699573    262.83185    264.45262    1.4699573 
    1700    44.988869    3421.4427    2141.3199    195.97211    1280.1228    180.56711    1326.1422    227.27194            0   -878.75929     595292.2    -594867.3    269.33339    55742.797    268.91342    1.2659937    264.28353    269.50173    1.2659937 
    1750     46.32512    3402.6047    2089.4689    191.22675    1313.1357    263.71155    1295.9383    229.85515            0   -905.40883     595296.3   -594867.26   -1711.6299    55742.797    262.56648   0.79625261    258.49733    263.09439   0.79625261 
    1800    47.626741    3381.3633    2132.4465    195.16003    1248.9167    234.45582    1241.8128    232.64927            0   -887.43322    595295.06   -594867.63    6.1750563    55742.797    268.02308   0.66339407    257.61935    269.20593   0.66339407 
    1850    48.859097    3358.9769    2090.1997    191.29363    1268.7772    207.84877    1271.8504    229.08032            0   -865.66614    595292.95   -594867.29    1046.4693    55742.797    262.66189   0.78698303    260.47063    262.99635   0.78698303 
    1900    50.086851     3336.417    2129.6659    194.90555    1206.7511    244.28118    1211.1819    208.93923            0   -884.87319    595293.88   -594866.65   -289.20276    55742.797    267.44697    1.2668343      256.868    268.64764    1.2668343 
    1950    51.245913    3311.0369    2068.2384    189.28375    1242.7985    243.85893    1242.1317    220.07989            0   -891.04779    595294.68   -594866.91   -1991.6618    55742.797     259.6859    1.3553911    254.54251     260.3233    1.3553911 
    2000    52.444694    3285.8337    2003.2382    183.33497    1282.5955    227.01654    1237.0479    227.77755            0   -837.34967     595295.6   -594867.49    937.91227    55742.797    251.65869   0.95505158    250.48617    251.88363   0.95505158 
Loop time of 52.4449 on 4 procs for 2000 steps with 4500 atoms

Performance: 1.647 ns/day, 14.568 hours/ns, 38.135 timesteps/s
98.1% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 26.398     | 27.961     | 29.034     |  18.3 | 53.31
Bond    | 1.3959     | 1.5762     | 1.7169     |   9.5 |  3.01
Kspace  | 17.592     | 18.436     | 19.757     |  18.9 | 35.15
Neigh   | 0.8492     | 0.85015    | 0.85101    |   0.1 |  1.62
Comm    | 1.311      | 1.6626     | 2.0789     |  22.0 |  3.17
Output  | 0.010571   | 0.011494   | 0.013821   |   1.3 |  0.02
Modify  | 1.8078     | 1.8237     | 1.8372     |   0.8 |  3.48
Other   |            | 0.1236     |            |       |  0.24

Nlocal:        1125.00 ave        1220 max        1043 min
Histogram: 1 0 1 0 0 0 1 0 0 1
Nghost:        5813.50 ave        5907 max        5699 min
Histogram: 1 0 0 1 0 0 0 0 1 1
Neighs:       202807.0 ave      217353 max      190808 min
Histogram: 1 1 0 0 0 0 1 0 0 1

Total # of neighbors = 811227
Ave neighs/atom = 180.27267
Ave special neighs/atom = 13.333333
Neighbor list builds = 31
Dangerous builds = 0
Total wall time: 0:00:52
